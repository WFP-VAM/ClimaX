# RAM-C work


## Scripts

* `src/data_preprocessing/nc2np_equally_chirps.py`: 

Before running the script, ensure that the necessary paths and directories are correctly set:
	* Modify PATH variable to point to the root directory of your project.
	* Add paths to sys.path for accessing ClimaX and hip-analysis modules.

### Main Functions
1. get_data(area): Retrieves and aligns datasets such as NDVI, LST, and rainfall data from CHIRPS and MODIS.
2. nc2np(path, variables, start_year, end_year, save_dir, partition, num_shards_per_year): Converts NetCDF files to NumPy arrays, applies normalization, and saves the data in NPZ format.
3. select_shape(array, out_lon, out_lat, n1=False): Selects a specific shape of the dataset based on given longitude and latitude dimensions.
4. main(root_dir, save_dir): Main function to process the datasets. It opens the necessary NetCDF files, calls select_shape, and processes the data using nc2np.


	The output files generated by the script are in two formats: `.npz` and `.npy`. These files are created after processing the input `.nc` (NetCDF) files. Here are the details of the output files:

1. `.npz` Files: These are NumPy archive files that store multiple NumPy arrays. For each year in the specified range, the script creates an `.npz` file containing the processed data for that year. The data is divided into different partitions (`train`, `val`, `test`) and further split into shards for each year, with filenames following the pattern `<year>_<shard_id>.npz`.

2. `.npy` Files: These are NumPy array files. The script generates `.npy` files for latitude and longitude data extracted from the input datasets. The filenames for these files are `lat.npy` and `lon.npy`.

Additionally, the script creates `.npz` files for normalization means (`normalize_mean.npz`) and standard deviations (`normalize_std.npz`) if the partition is `train`. It also generates a climatology file (`climatology.npz`) that contains the climatology data across the processed years.

   

* In configs/ we define the parameters of the architecture, the training,... 


* For ClimaX finetuning, we use climate_downscaling/train.py script with selecting needed arguments that are already defined in the config file. For example 

`python src/climax/climate_downscaling --mdoel.lr = 1e-1 --model.net.img_size=[32,64]`

## Notebooks

* ClimaX_Tutorial.ipynb: an exhaustive explanation of the preprocessing and a visulization of the finetuning results
